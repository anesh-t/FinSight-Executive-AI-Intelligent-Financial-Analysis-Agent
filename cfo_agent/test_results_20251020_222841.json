{
  "test_run": "2025-10-20T22:27:39.529197",
  "total_queries": 39,
  "passed": 38,
  "failed": 1,
  "results": {
    "1. BASIC FINANCIALS - Single Company": [
      {
        "query": "What was Apple's revenue in 2023?",
        "status": "PASSED",
        "response": "Apple Inc. (AAPL) reported revenue of $385.71B for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_annual_b, mv.r_and_d_expenses_annual/1e9 as rd_annual_b, mv.sg_and_a_expenses_annual/1e9 as sga_annual_b, mv.cogs_annual/1e9 as cogs_annual_b, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual/1e9 as operating_cash_flow, mv.cash_flow_investing_annual/1e9 as investing_cash_flow, mv.cash_flow_financing_annual/1e9 as financing_cash_flow, mv.capex_annual/1e9 as capex_annual_b, SUM(f.eps) as eps, SUM(f.dividends)/1e9 as dividends, SUM(f.buybacks)/1e9 as buybacks, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual FROM mv_financials_annual mv JOIN mv_ratios_annual r USING (company_id, fiscal_year) JOIN dim_company c USING (company_id) LEFT JOIN fact_financials f ON f.company_id = mv.company_id AND f.fiscal_year = mv.fiscal_year WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) GROUP BY c.ticker, c.name, mv.fiscal_year, mv.revenue_annual, mv.net_income_annual, mv.operating_income_annual, mv.gross_profit_annual, mv.r_and_d_expenses_annual, mv.sg_and_a_expenses_annual, mv.cogs_annual, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual, mv.cash_flow_investing_annual, mv.cash_flow_financing_annual, mv.capex_annual, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual ORDER BY mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Show Microsoft net income for 2023",
        "status": "PASSED",
        "response": "Microsoft Corporation (MSFT) reported net income of $82.54B for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_annual_b, mv.r_and_d_expenses_annual/1e9 as rd_annual_b, mv.sg_and_a_expenses_annual/1e9 as sga_annual_b, mv.cogs_annual/1e9 as cogs_annual_b, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual/1e9 as operating_cash_flow, mv.cash_flow_investing_annual/1e9 as investing_cash_flow, mv.cash_flow_financing_annual/1e9 as financing_cash_flow, mv.capex_annual/1e9 as capex_annual_b, SUM(f.eps) as eps, SUM(f.dividends)/1e9 as dividends, SUM(f.buybacks)/1e9 as buybacks, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual FROM mv_financials_annual mv JOIN mv_ratios_annual r USING (company_id, fiscal_year) JOIN dim_company c USING (company_id) LEFT JOIN fact_financials f ON f.company_id = mv.company_id AND f.fiscal_year = mv.fiscal_year WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) GROUP BY c.ticker, c.name, mv.fiscal_year, mv.revenue_annual, mv.net_income_annual, mv.operating_income_annual, mv.gross_profit_annual, mv.r_and_d_expenses_annual, mv.sg_and_a_expenses_annual, mv.cogs_annual, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual, mv.cash_flow_investing_annual, mv.cash_flow_financing_annual, mv.capex_annual, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual ORDER BY mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Google operating income 2023",
        "status": "PASSED",
        "response": "Alphabet Inc. (GOOG) reported operating income of $84.29B for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_annual_b, mv.r_and_d_expenses_annual/1e9 as rd_annual_b, mv.sg_and_a_expenses_annual/1e9 as sga_annual_b, mv.cogs_annual/1e9 as cogs_annual_b, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual/1e9 as operating_cash_flow, mv.cash_flow_investing_annual/1e9 as investing_cash_flow, mv.cash_flow_financing_annual/1e9 as financing_cash_flow, mv.capex_annual/1e9 as capex_annual_b, SUM(f.eps) as eps, SUM(f.dividends)/1e9 as dividends, SUM(f.buybacks)/1e9 as buybacks, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual FROM mv_financials_annual mv JOIN mv_ratios_annual r USING (company_id, fiscal_year) JOIN dim_company c USING (company_id) LEFT JOIN fact_financials f ON f.company_id = mv.company_id AND f.fiscal_year = mv.fiscal_year WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) GROUP BY c.ticker, c.name, mv.fiscal_year, mv.revenue_annual, mv.net_income_annual, mv.operating_income_annual, mv.gross_profit_annual, mv.r_and_d_expenses_annual, mv.sg_and_a_expenses_annual, mv.cogs_annual, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual, mv.cash_flow_investing_annual, mv.cash_flow_financing_annual, mv.capex_annual, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual ORDER BY mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Amazon gross profit in 2023",
        "status": "PASSED",
        "response": "Amazon.com Inc. (AMZN) reported gross profit of $270.05B for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_annual_b, mv.r_and_d_expenses_annual/1e9 as rd_annual_b, mv.sg_and_a_expenses_annual/1e9 as sga_annual_b, mv.cogs_annual/1e9 as cogs_annual_b, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual/1e9 as operating_cash_flow, mv.cash_flow_investing_annual/1e9 as investing_cash_flow, mv.cash_flow_financing_annual/1e9 as financing_cash_flow, mv.capex_annual/1e9 as capex_annual_b, SUM(f.eps) as eps, SUM(f.dividends)/1e9 as dividends, SUM(f.buybacks)/1e9 as buybacks, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual FROM mv_financials_annual mv JOIN mv_ratios_annual r USING (company_id, fiscal_year) JOIN dim_company c USING (company_id) LEFT JOIN fact_financials f ON f.company_id = mv.company_id AND f.fiscal_year = mv.fiscal_year WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) GROUP BY c.ticker, c.name, mv.fiscal_year, mv.revenue_annual, mv.net_income_annual, mv.operating_income_annual, mv.gross_profit_annual, mv.r_and_d_expenses_annual, mv.sg_and_a_expenses_annual, mv.cogs_annual, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual, mv.cash_flow_investing_annual, mv.cash_flow_financing_annual, mv.capex_annual, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual ORDER BY mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      }
    ],
    "2. BASIC FINANCIALS - Multiple Metrics": [
      {
        "query": "Show Apple revenue and net income for 2023",
        "status": "PASSED",
        "response": "Apple Inc. (AAPL) reported revenue of $385.71B, net income of $100.91B for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_annual_b, mv.r_and_d_expenses_annual/1e9 as rd_annual_b, mv.sg_and_a_expenses_annual/1e9 as sga_annual_b, mv.cogs_annual/1e9 as cogs_annual_b, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual/1e9 as operating_cash_flow, mv.cash_flow_investing_annual/1e9 as investing_cash_flow, mv.cash_flow_financing_annual/1e9 as financing_cash_flow, mv.capex_annual/1e9 as capex_annual_b, SUM(f.eps) as eps, SUM(f.dividends)/1e9 as dividends, SUM(f.buybacks)/1e9 as buybacks, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual FROM mv_financials_annual mv JOIN mv_ratios_annual r USING (company_id, fiscal_year) JOIN dim_company c USING (company_id) LEFT JOIN fact_financials f ON f.company_id = mv.company_id AND f.fiscal_year = mv.fiscal_year WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) GROUP BY c.ticker, c.name, mv.fiscal_year, mv.revenue_annual, mv.net_income_annual, mv.operating_income_annual, mv.gross_profit_annual, mv.r_and_d_expenses_annual, mv.sg_and_a_expenses_annual, mv.cogs_annual, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual, mv.cash_flow_investing_annual, mv.cash_flow_financing_annual, mv.capex_annual, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual ORDER BY mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "What was Microsoft's revenue, net income, and operating income in 2023?",
        "status": "PASSED",
        "response": "Microsoft Corporation (MSFT) reported revenue of $227.58B, net income of $82.54B, operating income of $100.53B for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_annual_b, mv.r_and_d_expenses_annual/1e9 as rd_annual_b, mv.sg_and_a_expenses_annual/1e9 as sga_annual_b, mv.cogs_annual/1e9 as cogs_annual_b, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual/1e9 as operating_cash_flow, mv.cash_flow_investing_annual/1e9 as investing_cash_flow, mv.cash_flow_financing_annual/1e9 as financing_cash_flow, mv.capex_annual/1e9 as capex_annual_b, SUM(f.eps) as eps, SUM(f.dividends)/1e9 as dividends, SUM(f.buybacks)/1e9 as buybacks, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual FROM mv_financials_annual mv JOIN mv_ratios_annual r USING (company_id, fiscal_year) JOIN dim_company c USING (company_id) LEFT JOIN fact_financials f ON f.company_id = mv.company_id AND f.fiscal_year = mv.fiscal_year WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) GROUP BY c.ticker, c.name, mv.fiscal_year, mv.revenue_annual, mv.net_income_annual, mv.operating_income_annual, mv.gross_profit_annual, mv.r_and_d_expenses_annual, mv.sg_and_a_expenses_annual, mv.cogs_annual, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual, mv.cash_flow_investing_annual, mv.cash_flow_financing_annual, mv.capex_annual, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual ORDER BY mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      }
    ],
    "3. BASIC FINANCIALS - Multi-Company": [
      {
        "query": "Compare revenue for Apple and Microsoft in 2023",
        "status": "PASSED",
        "response": "Here is the revenue for 2023:\n- **Apple Inc.**: $385.71B revenue\n- **Microsoft Corporation**: $227.58B revenue\n\n```\nticker                  name  fiscal_year            revenue_b         net_income_b          op_income_b       gross_profit_b    gross_margin_annual operating_margin_annual      net_margin_annual\n  AAPL            Apple Inc.         2023 385.7060000000000000 100.9130000000000000 118.6580000000000000 173.6710000000000000 0.45026782056799738661  0.30763846038174153371 0.26163191653746636039\n  MSFT Microsoft Corporation         2023 227.5830000000000000  82.5410000000000000 100.5330000000000000 158.7350000000000000 0.69748179784957575917  0.44174213363915582447 0.36268526208020809990\n```\n\nSources: Not available",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_b, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity as roe_annual, r.roa_annual FROM mv_financials_annual mv JOIN dim_company c USING (company_id) LEFT JOIN mv_ratios_annual r USING (company_id, fiscal_year) WHERE c.ticker IN (:t1, :t2) AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) ORDER BY c.ticker, mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Show net income for Apple, Microsoft, and Google 2023",
        "status": "PASSED",
        "response": "Here is the net income for 2023:\n- **Apple Inc.**: $100.91B net income\n- **Alphabet Inc.**: $73.80B net income\n\n```\nticker          name  fiscal_year            revenue_b         net_income_b          op_income_b       gross_profit_b    gross_margin_annual operating_margin_annual      net_margin_annual\n  AAPL    Apple Inc.         2023 385.7060000000000000 100.9130000000000000 118.6580000000000000 173.6710000000000000 0.45026782056799738661  0.30763846038174153371 0.26163191653746636039\n  GOOG Alphabet Inc.         2023 307.3940000000000000  73.7950000000000000  84.2930000000000000 174.0620000000000000 0.56625047984020507882  0.27421810445226647234 0.24006649446638516041\n```\n\nSources: Not available",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_b, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity as roe_annual, r.roa_annual FROM mv_financials_annual mv JOIN dim_company c USING (company_id) LEFT JOIN mv_ratios_annual r USING (company_id, fiscal_year) WHERE c.ticker IN (:t1, :t2) AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) ORDER BY c.ticker, mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      }
    ],
    "4. FINANCIAL RATIOS - Single Company": [
      {
        "query": "What is Apple's gross margin for 2023?",
        "status": "PASSED",
        "response": "Apple Inc. (AAPL) reported gross margin of 45.0% for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_annual_b, mv.r_and_d_expenses_annual/1e9 as rd_annual_b, mv.sg_and_a_expenses_annual/1e9 as sga_annual_b, mv.cogs_annual/1e9 as cogs_annual_b, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual/1e9 as operating_cash_flow, mv.cash_flow_investing_annual/1e9 as investing_cash_flow, mv.cash_flow_financing_annual/1e9 as financing_cash_flow, mv.capex_annual/1e9 as capex_annual_b, SUM(f.eps) as eps, SUM(f.dividends)/1e9 as dividends, SUM(f.buybacks)/1e9 as buybacks, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual FROM mv_financials_annual mv JOIN mv_ratios_annual r USING (company_id, fiscal_year) JOIN dim_company c USING (company_id) LEFT JOIN fact_financials f ON f.company_id = mv.company_id AND f.fiscal_year = mv.fiscal_year WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) GROUP BY c.ticker, c.name, mv.fiscal_year, mv.revenue_annual, mv.net_income_annual, mv.operating_income_annual, mv.gross_profit_annual, mv.r_and_d_expenses_annual, mv.sg_and_a_expenses_annual, mv.cogs_annual, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual, mv.cash_flow_investing_annual, mv.cash_flow_financing_annual, mv.capex_annual, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual ORDER BY mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Show Microsoft's ROE in 2023",
        "status": "PASSED",
        "response": "Microsoft Corporation (MSFT) reported ROE of 38.4% for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_annual_b, mv.r_and_d_expenses_annual/1e9 as rd_annual_b, mv.sg_and_a_expenses_annual/1e9 as sga_annual_b, mv.cogs_annual/1e9 as cogs_annual_b, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual/1e9 as operating_cash_flow, mv.cash_flow_investing_annual/1e9 as investing_cash_flow, mv.cash_flow_financing_annual/1e9 as financing_cash_flow, mv.capex_annual/1e9 as capex_annual_b, SUM(f.eps) as eps, SUM(f.dividends)/1e9 as dividends, SUM(f.buybacks)/1e9 as buybacks, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual FROM mv_financials_annual mv JOIN mv_ratios_annual r USING (company_id, fiscal_year) JOIN dim_company c USING (company_id) LEFT JOIN fact_financials f ON f.company_id = mv.company_id AND f.fiscal_year = mv.fiscal_year WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) GROUP BY c.ticker, c.name, mv.fiscal_year, mv.revenue_annual, mv.net_income_annual, mv.operating_income_annual, mv.gross_profit_annual, mv.r_and_d_expenses_annual, mv.sg_and_a_expenses_annual, mv.cogs_annual, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual, mv.cash_flow_investing_annual, mv.cash_flow_financing_annual, mv.capex_annual, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual ORDER BY mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Google operating margin 2023",
        "status": "PASSED",
        "response": "Alphabet Inc. (GOOG) reported operating margin of 27.4% for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_annual_b, mv.r_and_d_expenses_annual/1e9 as rd_annual_b, mv.sg_and_a_expenses_annual/1e9 as sga_annual_b, mv.cogs_annual/1e9 as cogs_annual_b, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual/1e9 as operating_cash_flow, mv.cash_flow_investing_annual/1e9 as investing_cash_flow, mv.cash_flow_financing_annual/1e9 as financing_cash_flow, mv.capex_annual/1e9 as capex_annual_b, SUM(f.eps) as eps, SUM(f.dividends)/1e9 as dividends, SUM(f.buybacks)/1e9 as buybacks, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual FROM mv_financials_annual mv JOIN mv_ratios_annual r USING (company_id, fiscal_year) JOIN dim_company c USING (company_id) LEFT JOIN fact_financials f ON f.company_id = mv.company_id AND f.fiscal_year = mv.fiscal_year WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) GROUP BY c.ticker, c.name, mv.fiscal_year, mv.revenue_annual, mv.net_income_annual, mv.operating_income_annual, mv.gross_profit_annual, mv.r_and_d_expenses_annual, mv.sg_and_a_expenses_annual, mv.cogs_annual, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual, mv.cash_flow_investing_annual, mv.cash_flow_financing_annual, mv.capex_annual, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual ORDER BY mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Amazon net margin 2023",
        "status": "PASSED",
        "response": "Amazon.com Inc. (AMZN) reported net margin of 5.3% for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_annual_b, mv.r_and_d_expenses_annual/1e9 as rd_annual_b, mv.sg_and_a_expenses_annual/1e9 as sga_annual_b, mv.cogs_annual/1e9 as cogs_annual_b, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual/1e9 as operating_cash_flow, mv.cash_flow_investing_annual/1e9 as investing_cash_flow, mv.cash_flow_financing_annual/1e9 as financing_cash_flow, mv.capex_annual/1e9 as capex_annual_b, SUM(f.eps) as eps, SUM(f.dividends)/1e9 as dividends, SUM(f.buybacks)/1e9 as buybacks, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual FROM mv_financials_annual mv JOIN mv_ratios_annual r USING (company_id, fiscal_year) JOIN dim_company c USING (company_id) LEFT JOIN fact_financials f ON f.company_id = mv.company_id AND f.fiscal_year = mv.fiscal_year WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) GROUP BY c.ticker, c.name, mv.fiscal_year, mv.revenue_annual, mv.net_income_annual, mv.operating_income_annual, mv.gross_profit_annual, mv.r_and_d_expenses_annual, mv.sg_and_a_expenses_annual, mv.cogs_annual, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual, mv.cash_flow_investing_annual, mv.cash_flow_financing_annual, mv.capex_annual, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual ORDER BY mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      }
    ],
    "5. FINANCIAL RATIOS - Multiple Ratios": [
      {
        "query": "Show Apple's gross margin, operating margin, and net margin for 2023",
        "status": "PASSED",
        "response": "Apple Inc. (AAPL) reported gross margin of 45.0%, operating margin of 30.8%, net margin of 26.2% for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_annual_b, mv.r_and_d_expenses_annual/1e9 as rd_annual_b, mv.sg_and_a_expenses_annual/1e9 as sga_annual_b, mv.cogs_annual/1e9 as cogs_annual_b, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual/1e9 as operating_cash_flow, mv.cash_flow_investing_annual/1e9 as investing_cash_flow, mv.cash_flow_financing_annual/1e9 as financing_cash_flow, mv.capex_annual/1e9 as capex_annual_b, SUM(f.eps) as eps, SUM(f.dividends)/1e9 as dividends, SUM(f.buybacks)/1e9 as buybacks, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual FROM mv_financials_annual mv JOIN mv_ratios_annual r USING (company_id, fiscal_year) JOIN dim_company c USING (company_id) LEFT JOIN fact_financials f ON f.company_id = mv.company_id AND f.fiscal_year = mv.fiscal_year WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) GROUP BY c.ticker, c.name, mv.fiscal_year, mv.revenue_annual, mv.net_income_annual, mv.operating_income_annual, mv.gross_profit_annual, mv.r_and_d_expenses_annual, mv.sg_and_a_expenses_annual, mv.cogs_annual, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual, mv.cash_flow_investing_annual, mv.cash_flow_financing_annual, mv.capex_annual, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual ORDER BY mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "What were Microsoft's ROE and ROA in 2023?",
        "status": "PASSED",
        "response": "Microsoft Corporation (MSFT) reported ROE of 38.4%, ROA of 19.3% for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_annual_b, mv.r_and_d_expenses_annual/1e9 as rd_annual_b, mv.sg_and_a_expenses_annual/1e9 as sga_annual_b, mv.cogs_annual/1e9 as cogs_annual_b, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual/1e9 as operating_cash_flow, mv.cash_flow_investing_annual/1e9 as investing_cash_flow, mv.cash_flow_financing_annual/1e9 as financing_cash_flow, mv.capex_annual/1e9 as capex_annual_b, SUM(f.eps) as eps, SUM(f.dividends)/1e9 as dividends, SUM(f.buybacks)/1e9 as buybacks, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual FROM mv_financials_annual mv JOIN mv_ratios_annual r USING (company_id, fiscal_year) JOIN dim_company c USING (company_id) LEFT JOIN fact_financials f ON f.company_id = mv.company_id AND f.fiscal_year = mv.fiscal_year WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) GROUP BY c.ticker, c.name, mv.fiscal_year, mv.revenue_annual, mv.net_income_annual, mv.operating_income_annual, mv.gross_profit_annual, mv.r_and_d_expenses_annual, mv.sg_and_a_expenses_annual, mv.cogs_annual, mv.total_assets_eoy, mv.total_liabilities_eoy, mv.equity_eoy, mv.cash_flow_ops_annual, mv.cash_flow_investing_annual, mv.cash_flow_financing_annual, mv.capex_annual, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity, r.roa_annual, r.debt_to_assets_annual, r.debt_to_equity_annual, r.rnd_to_revenue_annual, r.sgna_to_revenue_annual ORDER BY mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      }
    ],
    "6. FINANCIAL RATIOS - Multi-Company": [
      {
        "query": "Compare gross margin for Apple and Microsoft 2023",
        "status": "PASSED",
        "response": "Here is the gross margin for 2023:\n- **Apple Inc.**: 45.0% gross margin\n- **Microsoft Corporation**: 69.7% gross margin\n\n```\nticker                  name  fiscal_year            revenue_b         net_income_b          op_income_b       gross_profit_b    gross_margin_annual operating_margin_annual      net_margin_annual\n  AAPL            Apple Inc.         2023 385.7060000000000000 100.9130000000000000 118.6580000000000000 173.6710000000000000 0.45026782056799738661  0.30763846038174153371 0.26163191653746636039\n  MSFT Microsoft Corporation         2023 227.5830000000000000  82.5410000000000000 100.5330000000000000 158.7350000000000000 0.69748179784957575917  0.44174213363915582447 0.36268526208020809990\n```\n\nSources: Not available",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_b, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity as roe_annual, r.roa_annual FROM mv_financials_annual mv JOIN dim_company c USING (company_id) LEFT JOIN mv_ratios_annual r USING (company_id, fiscal_year) WHERE c.ticker IN (:t1, :t2) AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) ORDER BY c.ticker, mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Show net margin for Apple, Microsoft, Google 2023",
        "status": "PASSED",
        "response": "Here is the net margin for 2023:\n- **Apple Inc.**: 26.2% net margin\n- **Alphabet Inc.**: 24.0% net margin\n\n```\nticker          name  fiscal_year            revenue_b         net_income_b          op_income_b       gross_profit_b    gross_margin_annual operating_margin_annual      net_margin_annual\n  AAPL    Apple Inc.         2023 385.7060000000000000 100.9130000000000000 118.6580000000000000 173.6710000000000000 0.45026782056799738661  0.30763846038174153371 0.26163191653746636039\n  GOOG Alphabet Inc.         2023 307.3940000000000000  73.7950000000000000  84.2930000000000000 174.0620000000000000 0.56625047984020507882  0.27421810445226647234 0.24006649446638516041\n```\n\nSources: Not available",
        "sql_executed": [
          "SELECT c.ticker, c.name, mv.fiscal_year, mv.revenue_annual/1e9 as revenue_b, mv.net_income_annual/1e9 as net_income_b, mv.operating_income_annual/1e9 as op_income_b, mv.gross_profit_annual/1e9 as gross_profit_b, r.gross_margin_annual, r.operating_margin_annual, r.net_margin_annual, r.roe_annual_avg_equity as roe_annual, r.roa_annual FROM mv_financials_annual mv JOIN dim_company c USING (company_id) LEFT JOIN mv_ratios_annual r USING (company_id, fiscal_year) WHERE c.ticker IN (:t1, :t2) AND (CAST(:fy AS INTEGER) IS NULL OR mv.fiscal_year = :fy) ORDER BY c.ticker, mv.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      }
    ],
    "7. STOCK PRICES - Single Price Type": [
      {
        "query": "What was Apple's opening price in 2023?",
        "status": "PASSED",
        "response": "Apple Inc. (AAPL) reported opening price of $137.94 for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Show Microsoft closing price for 2023",
        "status": "PASSED",
        "response": "Microsoft Corporation (MSFT) reported closing price of $376.04 for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Google high price 2023",
        "status": "PASSED",
        "response": "Alphabet Inc. (GOOG) reported high price of $142.97 for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Amazon low price 2023",
        "status": "PASSED",
        "response": "Amazon.com Inc. (AMZN) reported low price of $81.43 for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      }
    ],
    "8. STOCK PRICES - Multiple Price Types": [
      {
        "query": "Show Apple opening and closing price for 2023",
        "status": "PASSED",
        "response": "Apple Inc. (AAPL) reported opening price of $137.94, closing price of $194.71 for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "What were Microsoft's high and low prices in 2023?",
        "status": "PASSED",
        "response": "Microsoft Corporation (MSFT) reported high price of $384.30, low price of $219.35 for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      }
    ],
    "9. STOCK PRICES - Multi-Company": [
      {
        "query": "Show closing price for Apple and Microsoft 2023",
        "status": "PASSED",
        "response": "Here is the closing price for 2023:\n- **Apple Inc.**: $194.71 closing price\n- **Microsoft Corporation**: $376.04 closing price\n\n```\nticker                  name  fiscal_year     avg_price_annual avg_open_price_annual avg_close_price_annual high_price_annual low_price_annual close_price_eoy          return_annual\n  AAPL            Apple Inc.         2023 161.1424988750000000  137.9399985000000000   186.5225030000000000        196.729996       124.169998      194.710007 0.35243457419994044454\n  MSFT Microsoft Corporation         2023 313.3999977125000000  296.2674980000000000   330.1575012000000000       384.2999878      219.3500061     376.0400085 0.54698044148196151610\n```\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit | SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Compare opening price for Apple, Microsoft, Google 2023",
        "status": "PASSED",
        "response": "Here is the opening price for 2023:\n- **Alphabet Inc.**: $110.49 opening price\n- **Apple Inc.**: $137.94 opening price\n- **Microsoft Corporation**: $296.27 opening price\n\n```\nticker                  name  fiscal_year     avg_price_annual avg_open_price_annual avg_close_price_annual high_price_annual low_price_annual close_price_eoy          return_annual\n  GOOG         Alphabet Inc.         2023 117.6306453487500000  110.4876564425000000   123.5917301250000000       142.9666425      84.98839839     139.9721375 0.56885235554725678672\n  AAPL            Apple Inc.         2023 161.1424988750000000  137.9399985000000000   186.5225030000000000        196.729996       124.169998      194.710007 0.35243457419994044454\n  MSFT Microsoft Corporation         2023 313.3999977125000000  296.2674980000000000   330.1575012000000000       384.2999878      219.3500061     376.0400085 0.54698044148196151610\n```\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit | SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit | SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      }
    ],
    "10. STOCK PRICES - Average vs Actual": [
      {
        "query": "Show Apple closing price for 2023",
        "status": "PASSED",
        "response": "Apple Inc. (AAPL) reported closing price of $194.71 for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Show Apple average closing price for 2023",
        "status": "PASSED",
        "response": "Apple Inc. (AAPL) reported average closing price of $186.52, average price of $161.14 for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Microsoft opening price 2023",
        "status": "PASSED",
        "response": "Microsoft Corporation (MSFT) reported opening price of $296.27 for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Microsoft average opening price 2023",
        "status": "PASSED",
        "response": "Microsoft Corporation (MSFT) reported average opening price of $296.27, average price of $313.40 for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      }
    ],
    "11. COMBINED QUERIES - Financials + Ratios + Stock": [
      {
        "query": "Show Apple revenue, net margin, and closing stock price for 2023",
        "status": "PASSED",
        "response": "Apple Inc. (AAPL) reported closing price of $194.71 for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "What were Microsoft's revenue, ROE, and stock return in 2023?",
        "status": "PASSED",
        "response": "Microsoft Corporation (MSFT) reported average stock price of $313.40, year-high/low of $219.35-$384.30, annual return of +54.7% for FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sa.fiscal_year, sa.avg_price_annual, sa.avg_open_price_annual, sa.avg_close_price_annual, sa.high_price_annual, sa.low_price_annual, sa.close_price_eoy, sa.return_annual, sa.volatility_pct_annual, sa.volume_total_annual, sa.volume_avg_annual, sa.dividend_per_share_annual, sa.dividend_yield_annual FROM mv_stock_prices_annual sa JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sa.fiscal_year = :fy) ORDER BY sa.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      }
    ],
    "12. QUARTERLY DATA": [
      {
        "query": "What was Apple's revenue in Q4 2023?",
        "status": "PASSED",
        "response": "Apple Inc. (AAPL) reported revenue of $119.58B for Q4 FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, f.fiscal_year, f.fiscal_quarter, f.revenue/1e9 as revenue_b, f.net_income/1e9 as net_income_b, f.operating_income/1e9 as op_income_b, f.gross_profit/1e9 as gross_profit_b, f.r_and_d_expenses/1e9 as rd_b, f.sg_and_a_expenses/1e9 as sga_b, f.cogs/1e9 as cogs_b, f.cash_flow_ops/1e9 as operating_cash_flow, f.cash_flow_investing/1e9 as investing_cash_flow, f.cash_flow_financing/1e9 as financing_cash_flow, f.capex/1e9 as capex, f.dividends/1e9 as dividends, f.buybacks/1e9 as buybacks, f.eps, f.total_assets, f.total_liabilities, f.equity, r.gross_margin, r.operating_margin, r.net_margin, r.roe, r.roa, r.debt_to_equity, r.debt_to_assets, r.rnd_to_revenue, r.sgna_to_revenue FROM fact_financials f JOIN dim_company c USING (company_id) LEFT JOIN vw_ratios_quarter r ON r.company_id = f.company_id AND r.fiscal_year = f.fiscal_year AND r.fiscal_quarter = f.fiscal_quarter WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR f.fiscal_year = :fy) AND (CAST(:fq AS INTEGER) IS NULL OR f.fiscal_quarter = :fq) ORDER BY f.fiscal_year DESC, f.fiscal_quarter DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Show Microsoft net income for Q3 2023",
        "status": "PASSED",
        "response": "Microsoft Corporation (MSFT) reported net income of $22.29B for Q3 FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, f.fiscal_year, f.fiscal_quarter, f.revenue/1e9 as revenue_b, f.net_income/1e9 as net_income_b, f.operating_income/1e9 as op_income_b, f.gross_profit/1e9 as gross_profit_b, f.r_and_d_expenses/1e9 as rd_b, f.sg_and_a_expenses/1e9 as sga_b, f.cogs/1e9 as cogs_b, f.cash_flow_ops/1e9 as operating_cash_flow, f.cash_flow_investing/1e9 as investing_cash_flow, f.cash_flow_financing/1e9 as financing_cash_flow, f.capex/1e9 as capex, f.dividends/1e9 as dividends, f.buybacks/1e9 as buybacks, f.eps, f.total_assets, f.total_liabilities, f.equity, r.gross_margin, r.operating_margin, r.net_margin, r.roe, r.roa, r.debt_to_equity, r.debt_to_assets, r.rnd_to_revenue, r.sgna_to_revenue FROM fact_financials f JOIN dim_company c USING (company_id) LEFT JOIN vw_ratios_quarter r ON r.company_id = f.company_id AND r.fiscal_year = f.fiscal_year AND r.fiscal_quarter = f.fiscal_quarter WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR f.fiscal_year = :fy) AND (CAST(:fq AS INTEGER) IS NULL OR f.fiscal_quarter = :fq) ORDER BY f.fiscal_year DESC, f.fiscal_quarter DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Apple closing stock price Q2 2023",
        "status": "PASSED",
        "response": "Data found for Apple Inc. (AAPL) in Q2 FY2023.\n\nSources: ALPHAVANTAGE_FIN (as_reported, 2025-10-12 10:33:18); YF; FRED",
        "sql_executed": [
          "SELECT c.ticker, c.name, sq.fiscal_year, sq.fiscal_quarter, sq.avg_price, sq.open_price, sq.close_price, sq.high_price, sq.low_price, sq.return_qoq, sq.return_yoy, sq.price_change_abs, sq.price_change_pct, sq.volatility_pct, sq.volume_total, sq.volume_avg, sq.dividend_yield, sq.dividend_per_share FROM vw_stock_prices_quarter sq JOIN dim_company c USING (company_id) WHERE c.ticker = :ticker AND (CAST(:fy AS INTEGER) IS NULL OR sq.fiscal_year = :fy) AND (CAST(:fq AS INTEGER) IS NULL OR sq.fiscal_quarter = :fq) ORDER BY sq.fiscal_year DESC, sq.fiscal_quarter DESC LIMIT :limit"
        ],
        "errors": []
      }
    ],
    "13. MACRO INDICATORS": [
      {
        "query": "What was GDP in 2023?",
        "status": "PASSED",
        "response": "Macro indicators for FY2023: Real GDP (annual average) of $22671.10B.\n\nSources: Not available",
        "sql_executed": [
          "SELECT ma.fiscal_year, ma.gdp_annual, ma.pce_annual, ma.cpi_annual, ma.core_cpi_annual, ma.pce_price_index_annual, ma.unemployment_rate_annual, ma.fed_funds_rate_annual, ma.term_spread_10y_2y_annual, ma.sp500_index_annual, ma.vix_index_annual, ma.gdp_q4, ma.cpi_q4, ma.unemployment_rate_q4, ma.fed_funds_rate_q4, ma.sp500_index_q4 FROM mv_macro_annual ma WHERE (CAST(:fy AS INTEGER) IS NULL OR ma.fiscal_year = :fy) ORDER BY ma.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Show CPI for 2023",
        "status": "PASSED",
        "response": "Macro indicators for FY2023: CPI (annual average) of 304.70, Core CPI (annual average) of 308.38.\n\nSources: Not available",
        "sql_executed": [
          "SELECT ma.fiscal_year, ma.gdp_annual, ma.pce_annual, ma.cpi_annual, ma.core_cpi_annual, ma.pce_price_index_annual, ma.unemployment_rate_annual, ma.fed_funds_rate_annual, ma.term_spread_10y_2y_annual, ma.sp500_index_annual, ma.vix_index_annual, ma.gdp_q4, ma.cpi_q4, ma.unemployment_rate_q4, ma.fed_funds_rate_q4, ma.sp500_index_q4 FROM mv_macro_annual ma WHERE (CAST(:fy AS INTEGER) IS NULL OR ma.fiscal_year = :fy) ORDER BY ma.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Unemployment rate in 2023",
        "status": "PASSED",
        "response": "Macro indicators for FY2023: unemployment rate (annual average) of 3.63%.\n\nSources: Not available",
        "sql_executed": [
          "SELECT ma.fiscal_year, ma.gdp_annual, ma.pce_annual, ma.cpi_annual, ma.core_cpi_annual, ma.pce_price_index_annual, ma.unemployment_rate_annual, ma.fed_funds_rate_annual, ma.term_spread_10y_2y_annual, ma.sp500_index_annual, ma.vix_index_annual, ma.gdp_q4, ma.cpi_q4, ma.unemployment_rate_q4, ma.fed_funds_rate_q4, ma.sp500_index_q4 FROM mv_macro_annual ma WHERE (CAST(:fy AS INTEGER) IS NULL OR ma.fiscal_year = :fy) ORDER BY ma.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      },
      {
        "query": "Fed funds rate 2023",
        "status": "PASSED",
        "response": "Macro indicators for FY2023: Federal Funds Rate (annual average) of 5.02%.\n\nSources: Not available",
        "sql_executed": [
          "SELECT ma.fiscal_year, ma.gdp_annual, ma.pce_annual, ma.cpi_annual, ma.core_cpi_annual, ma.pce_price_index_annual, ma.unemployment_rate_annual, ma.fed_funds_rate_annual, ma.term_spread_10y_2y_annual, ma.sp500_index_annual, ma.vix_index_annual, ma.gdp_q4, ma.cpi_q4, ma.unemployment_rate_q4, ma.fed_funds_rate_q4, ma.sp500_index_q4 FROM mv_macro_annual ma WHERE (CAST(:fy AS INTEGER) IS NULL OR ma.fiscal_year = :fy) ORDER BY ma.fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      }
    ],
    "14. MACRO WITH FINANCIALS": [
      {
        "query": "How did Apple perform in 2023 with GDP context?",
        "status": "FAILED",
        "response": null,
        "error": "[Errno 32] Broken pipe"
      },
      {
        "query": "Compare Apple and Microsoft with macro indicators in 2023",
        "status": "PASSED",
        "response": "Here is the revenue for 2023:\n- **Apple Inc.**: $385.71B revenue\n- **Microsoft Corporation**: $227.58B revenue\n\n```\nticker                  name  fiscal_year            revenue_b         net_income_b    gross_margin_annual operating_margin_annual      net_margin_annual               gdp_t           cpi_annual\n  AAPL            Apple Inc.         2023 385.7060000000000000 100.9130000000000000 0.45026782056799738661  0.30763846038174153371 0.26163191653746636039 22.6710965000000000 304.7041666666666550\n  MSFT Microsoft Corporation         2023 227.5830000000000000  82.5410000000000000 0.69748179784957575917  0.44174213363915582447 0.36268526208020809990 22.6710965000000000 304.7041666666666550\n```\n\nSources: Not available",
        "sql_executed": [
          "SELECT ticker, name, fiscal_year, revenue_annual/1e9 as revenue_b, net_income_annual/1e9 as net_income_b, gross_margin_annual, operating_margin_annual, net_margin_annual, gdp_annual/1e3 as gdp_t, cpi_annual, unemployment_rate_annual, fed_funds_rate_annual FROM mv_company_macro_context_annual WHERE ticker IN (:t1, :t2) AND (CAST(:fy AS INTEGER) IS NULL OR fiscal_year = :fy) ORDER BY ticker, fiscal_year DESC LIMIT :limit"
        ],
        "errors": []
      }
    ]
  }
}